package org.mitre.eren.protocol.scenario;

import java.io.StringReader;

import org.apache.abdera.Abdera;
import org.apache.abdera.factory.Factory;
import org.apache.abdera.model.Document;
import org.apache.abdera.parser.Parser;
import org.opencare.lib.model.ExtensionFactory;
import org.opencare.lib.model.edxl.EDXLDistribution;
import org.opencare.lib.model.edxl.EmbeddedXMLContent;

import org.mitre.eren.protocol.ERENConstants;
import org.mitre.eren.protocol.kml.KMLExtensionFactory;
import org.mitre.eren.protocol.startup.StartupConstants;
import org.mitre.eren.protocol.startup.StartupExtensionFactory;

public class ScenarioTestHarness implements ERENConstants, StartupConstants, ScenarioConstants {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub

		Abdera abdera = Abdera.getInstance();
		Factory factory = abdera.getFactory();
		factory.registerExtension(new ExtensionFactory());
		factory.registerExtension(new ScenarioExtensionFactory());
		factory.registerExtension(new StartupExtensionFactory());
		factory.registerExtension(new KMLExtensionFactory());
		
		Parser p = factory.newParser();
		
		Document<EDXLDistribution> doc = p.parse(new StringReader(sceanrioBlob));
		
		EDXLDistribution edxl = doc.getRoot();
		System.out.println("EDXL: " + edxl);
		
		EmbeddedXMLContent exc = edxl.getContentObject().get(0).getXmlContent().getEmbeddedXMLContent().get(0);
		ERENscenario scen = exc.getExtension(EREN_SCENARIO);
		
		Facilities fac = scen.getFacilities();
		System.out.println("Facilities: " + fac);
		
		EOC eoc = fac.getEoc();
		System.out.println("Eoc:" + eoc);
		
		Location loc = eoc.getLocation();
		System.out.println("Loc: " + loc);
		
	}
	//private static Logger log = LoggingUtils.getLogger(ScenarioTestHarness.class);
	
	private static String sceanrioBlob = "<?xml version=\"1.0\" encoding=\"utf-8\"?><EDXLDistribution xmlns=\"urn:oasis:names:tc:emergency:EDXL:DE:1.0\"><distributionID>1</distributionID><distributionStatus>System</distributionStatus><distributionType>Update</distributionType><senderID>scenariomgr@erenbus.mitre.org</senderID><combinedConfidentiality>UNCLASSIFIED AND NOT SENSITIVE</combinedConfidentiality><language>EN</language><contentObject><xmlContent xmlns:eren=\"urn:mitre:eren:1.0\"><embeddedXMLContent><eren:scenario xmlns:kml=\"http://www.opengis.net/kml/2.2\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><eren:event ID=\"Event_01\" xsi:type=\"AnthraxEventType\"><eren:description>Aerosolized Anthrax release in Norfolk, VA</eren:description><eren:location><eren:line><kml:tessellate>1</kml:tessellate><kml:coordinates>-76.425616362551,36.78683987009428,0           -76.42385809200974,36.90085599224829,0           -76.40180834789931,36.94130686004286,0           -76.42648347824424,36.98591283205224,0           -76.37733922082605,37.03089886293282,0</kml:coordinates></eren:line></eren:location><eren:time>12345</eren:time></eren:event><eren:county><eren:name>Norfolk</eren:name><eren:state>VA</eren:state><eren:location><eren:kmlLocation><kml:longitude>-76.201867</kml:longitude><kml:latitude>36.91</kml:latitude></eren:kmlLocation></eren:location><eren:population>1795015</eren:population></eren:county><eren:facilities><eren:eoc ID=\"EOC_01\" Name=\"Norfolk EOC\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.385351</kml:longitude><kml:latitude>37.036984</kml:latitude></eren:kmlLocation></eren:location></eren:eoc><eren:pod ID=\"POD_01\" Name=\"Hampton Coliseum\"><eren:status>Not Requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.385351</kml:longitude><kml:latitude>37.036984</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>80</eren:min><eren:max>120</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>20</eren:min><eren:max>50</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Support</eren:function><eren:min>30</eren:min><eren:max>40</eren:max><eren:current>0</eren:current></eren:staff><eren:localPopulation>1000</eren:localPopulation><eren:throughput>750</eren:throughput></eren:pod><eren:pod ID=\"POD_02\" Name=\"Harbor Park Stadium\"><eren:status>Not Requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.278873</kml:longitude><kml:latitude>36.842710</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>80</eren:min><eren:max>120</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>20</eren:min><eren:max>50</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Support</eren:function><eren:min>30</eren:min><eren:max>40</eren:max><eren:current>0</eren:current></eren:staff><eren:localPopulation>1000</eren:localPopulation><eren:throughput>750</eren:throughput></eren:pod><eren:pod ID=\"POD_03\" Name=\"Norfolk Naval Shipyard\"><eren:status>Not Requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.297222</kml:longitude><kml:latitude>36.815278</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>80</eren:min><eren:max>120</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>20</eren:min><eren:max>50</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Support</eren:function><eren:min>30</eren:min><eren:max>40</eren:max><eren:current>0</eren:current></eren:staff><eren:localPopulation>1000</eren:localPopulation><eren:throughput>750</eren:throughput></eren:pod><eren:pod ID=\"POD_04\" Name=\"Churchland Park\"><eren:status>Not Requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.370121</kml:longitude><kml:latitude>36.887287</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>80</eren:min><eren:max>120</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>20</eren:min><eren:max>50</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Support</eren:function><eren:min>30</eren:min><eren:max>40</eren:max><eren:current>0</eren:current></eren:staff><eren:localPopulation>1000</eren:localPopulation><eren:throughput>750</eren:throughput></eren:pod><eren:pod ID=\"POD_05\" Name=\"Oak Grove Lake park\"><eren:status>Not Requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.258050</kml:longitude><kml:latitude>36.751180</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>80</eren:min><eren:max>120</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>20</eren:min><eren:max>50</eren:max><eren:current>0</eren:current></eren:staff><eren:staff><eren:function>Support</eren:function><eren:min>30</eren:min><eren:max>40</eren:max><eren:current>0</eren:current></eren:staff><eren:localPopulation>1000</eren:localPopulation><eren:throughput>750</eren:throughput></eren:pod><eren:hospital ID=\"hospital_01\" Name=\"Sentara Norfolk General Hospital\"><eren:status>Normal</eren:status><eren:availability>0</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.302990</kml:longitude><kml:latitude>36.861527</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>700</eren:min><eren:max>1200</eren:max><eren:current>500</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>30</eren:min><eren:max>50</eren:max><eren:current>10</eren:current></eren:staff><eren:capacity>1000</eren:capacity><eren:filled>800</eren:filled></eren:hospital><eren:hospital ID=\"hospital_02\" Name=\"Leigh Memorial Hospital\"><eren:status>Normal</eren:status><eren:availability>0</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.190102</kml:longitude><kml:latitude>36.850843</kml:latitude></eren:kmlLocation></eren:location><eren:staff><eren:function>Medical</eren:function><eren:min>700</eren:min><eren:max>1200</eren:max><eren:current>500</eren:current></eren:staff><eren:staff><eren:function>Security</eren:function><eren:min>30</eren:min><eren:max>50</eren:max><eren:current>10</eren:current></eren:staff><eren:capacity>1000</eren:capacity><eren:filled>800</eren:filled></eren:hospital><eren:airport ID=\"Airport_01\" Name=\"Norfolk International Airport\" code=\"ORF\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.205764</kml:longitude><kml:latitude>36.898670</kml:latitude></eren:kmlLocation></eren:location></eren:airport><eren:rss ID=\"RSS_01\"><eren:status>Requested</eren:status><eren:availability>1000</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.205764</kml:longitude><kml:latitude>36.898670</kml:latitude></eren:kmlLocation></eren:location></eren:rss></eren:facilities><eren:vehicles><eren:policeCar ID=\"cruiser_01\" OwnerID=\"1234\"><eren:status>Not requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.258050</kml:longitude><kml:latitude>36.751180</kml:latitude></eren:kmlLocation></eren:location></eren:policeCar><eren:policeCar ID=\"cruiser_02\" OwnerID=\"5678\"><eren:status>Not requested</eren:status><eren:availability>45678</eren:availability><eren:location><eren:kmlLocation><kml:longitude>-76.258050</kml:longitude><kml:latitude>36.751180</kml:latitude></eren:kmlLocation></eren:location></eren:policeCar></eren:vehicles><eren:people><eren:staff ID=\"staff_01\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:quantity>1000</eren:quantity><eren:function>Medical</eren:function></eren:staff><eren:staff ID=\"staff_02\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:quantity>1000</eren:quantity><eren:function>Security</eren:function></eren:staff><eren:staff ID=\"staff_03\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:quantity>800</eren:quantity><eren:function>Support</eren:function></eren:staff><eren:staff ID=\"staff_04\"><eren:status>Active</eren:status><eren:availability>0</eren:availability><eren:quantity>100</eren:quantity><eren:function>Truck Driver</eren:function></eren:staff><eren:staff ID=\"staff_05\"><eren:status>Requested</eren:status><eren:availability>123545</eren:availability><eren:quantity>2000</eren:quantity><eren:function>Security</eren:function></eren:staff></eren:people><eren:equipment><eren:podEquipment ID=\"equip_01\"><eren:status>Not requested</eren:status><eren:availability>0</eren:availability><eren:location><eren:facility>EOC_01</eren:facility></eren:location><eren:quantity>10</eren:quantity></eren:podEquipment><eren:medication ID=\"drugs_01\"><eren:status>Requested</eren:status><eren:availability>34566</eren:availability><eren:location><eren:facility>Airport_01</eren:facility></eren:location><eren:quantity>10000</eren:quantity></eren:medication></eren:equipment></eren:scenario></embeddedXMLContent></xmlContent></contentObject></EDXLDistribution>";
}
